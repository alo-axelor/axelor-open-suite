<?xml version="1.0" encoding="UTF-8"?>
<object-views xmlns="http://axelor.com/xml/ns/object-views"
  xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
  xsi:schemaLocation="http://axelor.com/xml/ns/object-views http://axelor.com/xml/ns/object-views/object-views_5.4.xsd">

  <grid model="com.axelor.apps.base.db.DataBackupConfigAnonymizeLine"
    title="Data backup config anonymize lines" name="data-backup-config-anonymize-line-grid">
    <field name="metaModel"/>
    <field name="metaField"/>
    <field name="metaJsonField"/>
  </grid>

  <form model="com.axelor.apps.base.db.DataBackupConfigAnonymizeLine"
    title="Data backup config anonymize line" name="data-backup-config-anonymize-line-form"
    onLoad="action-data-backup-config-anonymize-line-attr-display-meta-json-field">
    <panel name="mainPanel">
      <field name="metaModel" grid-view="meta-model-grid" form-view="meta-model-form"
        onChange="action-data-backup-config-anonymize-line-group-metamodel-onchange"/>
      <field name="metaField" grid-view="meta-field-details-grid" canNew="false"
        canEdit="false"
        domain="self.typeName in ('String','Integer','LocalDateTime','Long','Double','LocalTime','ZonedDateTime','BigDecimal','LocalDate')
        and self.metaModel = :metaModel and not (self.metaModel.name = 'User' and self.name='password')
        and not (self.metaModel.name = 'Partner' and self.name='fullName')
        and not (self.metaModel.name = 'Partner' and self.name='simpleFullName')"
        onChange="action-data-backup-config-anonymize-line-group-metafield-onchange"
        readonlyIf="metaModel == null"/>
      <field name="metaJsonField" hidden="true"
        onSelect="action-data-backup-config-anonymize-line-attr-on-select-meta-json-field"/>
      <field name="useFakeData"/>
      <field name="fakerApiField" grid-view="faker-api-field-grid"
        form-view="faker-api-field-form" hidden="true" showIf="useFakeData" requiredIf="useFakeData"/>
    </panel>
  </form>

  <action-group
    name="action-data-backup-config-anonymize-line-group-metamodel-onchange">
    <action name="action-data-backup-config-anonymize-line-attrs-empty-fields"/>
    <action
      name="action-data-backup-config-anonymize-line-attrs-meta-json-field-hidden-onchange-meta-model"/>
  </action-group>

  <action-group
    name="action-data-backup-config-anonymize-line-group-metafield-onchange">
    <action name="action-data-backup-config-anonymize-line-attr-display-meta-json-field"/>
    <action name="action-data-backup-config-anonymize-line-attrs-empty-faker-api-field"/>
  </action-group>

  <action-attrs name="action-data-backup-config-anonymize-line-attrs-empty-fields">
    <attribute for="metaField, fakerApiField, metaJsonField" name="value"
      expr="eval: null"/>
  </action-attrs>

  <action-attrs
    name="action-data-backup-config-anonymize-line-attrs-empty-meta-json-field">
    <attribute for="metaJsonField" name="value" expr="eval: null"/>
  </action-attrs>

  <action-attrs
    name="action-data-backup-config-anonymize-line-attrs-empty-faker-api-field">
    <attribute for="fakerApiField, metaJsonField" name="value" expr="eval: null"/>
  </action-attrs>

  <action-attrs
    name="action-data-backup-config-anonymize-line-attrs-faker-api-field-required">
    <attribute for="fakerApiField" name="required" expr="true" if="useFakeData"/>
    <attribute for="fakerApiField" name="required" expr="false" if="!useFakeData"/>
  </action-attrs>

  <action-attrs
    name="action-data-backup-config-anonymize-line-attr-display-meta-json-field">
    <attribute name="hidden" for="metaJsonField"
      expr="eval:__this__?.metaField.json == false" if="eval:__this__?.metaField != null"/>
    <attribute name="value" for="metaJsonField" expr="eval:null"
      if="eval:__this__?.metaField == null || __this__?.metaField.json == false"/>
  </action-attrs>

  <action-attrs
    name="action-data-backup-config-anonymize-line-attrs-meta-json-field-hidden-onchange-meta-model">
    <attribute for="metaJsonField" name="hidden" expr="true"/>
  </action-attrs>

  <action-attrs
    name="action-data-backup-config-anonymize-line-attr-on-select-meta-json-field">
    <attribute name="domain" for="metaJsonField"
      expr="eval:&quot; self.type NOT IN ('panel', 'button', 'label', 'spacer', 'separator') AND self.model = 'com.axelor.apps.base.db.${metaModel?.name}' AND self.modelField = '${metaField?.name}' &quot;"/>
  </action-attrs>

</object-views>
